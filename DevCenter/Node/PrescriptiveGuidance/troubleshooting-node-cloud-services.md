#Troubleshooting Node.js Applications Hosted in Windows Azure Cloud Services

There are several tools and configuration settings available to assist with troubleshooting Node.js applications hosted in a Windows Azure Cloud Service. This article provides guidance on how to use these tools and configuration settings to gain insight into problems that may occur in your application.

The task inclues the following steps:

* [Using IISNode Configuration] (#IISNode)
	* [Configuration Changes for Running Applications] (#Autoupdate)
* [Using Windows AzureDiagnostics] (#Diagnostics)
* [Remote Desktop] (#RDP)

<h2 id="IISNode">Using IISNode Configuration Settings with Web Roles</h2>

When hosting an application in either a Windows Azure Web Site or a Cloud Service Worker Role, [IISNode] is loaded as part of the hosting environment and provides several configuration options useful for troubleshooting your application.

IISNode reads configuration settings from the **iisnode.yml** file. This is an optional file, so it may not exist as part of your deployment. The file must be located in the root directory of your application. The the general format of the **iisnode.yml** file is **configuration\_setting**: **value**. The following is an example of a basic troubleshooting configuration:

	node_env: development
	devErrorsEnabled: true
	loggingEnabled: true

The above configuration settings result in the following:

* node_env: Sets the NODE_ENV environment variable to a value of 'development'.

* devErrorsEnabled: Returns detailed error information to the browser when an error occurs.

* loggingEnabled: Captures information sent to stdout and stderr and makes it available for viewing over HTTP.

	The log files created through this process are stored in the directory specified by the **logDirectory** setting. The default value of **logDirectory** is **iisnode**.


The following table contains a list of settings that are useful for troubleshooting application errors. For a complete listing of the configuration settings available, see [iisnode.yml sample configuration][iisnode-sample-config].


<td>debuggingEnabled</td><td><p>If <strong>true</strong>, enables in-browser debugging from WebKit-enabled browsers.</p>
<p>Default: <strong>false</strong></p>
<p>A debugging session can be started by navigating to the application URL, including the *.js name, such as server.js, and appending the URL path segment specified by the <strong>debuggerPathSegment</strong> setting. For example, http://</p><p>The default value of <strong>debuggerPathSegment</strong> is <strong>debug</strong>.</p>
</td>
</tr>
</table>

<h3 id="Autoupdate">Configuration Changes for Running Applications</h3>

By default, changes to **iisnode.yml** are picked up immediately and the application process will be recycled. This is a graceful process, and any active requests are allowed to complete before the process is recycled. However any new request will be handled by a new process created using the new configuration values.

<h2 id="Diagnostics">Using Windows Azure Diagnostics</h2>

<h2 id="RDP">Remote Desktop</h2>

Remote desktop can be enabled for your Cloud Serivce, and allows you to connect to the desktop session of the virtual machine that hosts your application instance. This can be useful if you need to make changes directly to your application to diagnose a problem, or to directly access log files generated by your application. The remote desktop session provides you with basic Windows tools such as the managment console, cmd.exe, and event logging.

<div class="dev-callout">
<strong>Note</strong>
<p>Any changes you directly make to an instance, such as modifying the application to introduce additional instrumentation, installation of additional tools and utilities, or configuration settings, will not persist if the role instance (the VM) recycles. Since the role instance may be recycled at any time as part of the normal operation of Windows Azure, any changes you make that need to be implemented as part of long term diagnostics, or as a permanent fix, should be applied to the application's Cloud Service project and redeployed to Windows Azure.</p>
</div>

For more information on enabling and using Remote Desktop, see [Enable Remote Desktop][rdp].



[tshoot-node-website]: http://windowsazure.com/
[iisnode-sample-config]: https://github.com/tjanczuk/iisnode/blob/master/src/samples/configuration/iisnode.yml
[rdp]: /en-us/develop/nodejs/common-tasks/enable-remote-desktop/