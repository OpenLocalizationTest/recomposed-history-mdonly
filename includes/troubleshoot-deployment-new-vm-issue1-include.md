### Issue 1: You’re using a custom image, and the audit log indicates either a provisioning timeout or a provisioning failure

Provisioning errors arise if you upload or capture a generalized VM image as a specialized VM image or vice versa. The former will cause a provisioning timeout error and the latter will cause a provisioning failure. To deploy your custom image without errors, you must ensure that the type of the image does not change during the capture process.

The following table lists the possible combinations of generalized and specialized images, the error type you will encounter and what you need to do to fix the errors.

| OS status \ Process stage | If Uploaded as Specialized                                                                                                               | If Uploaded as Generalized                                                                                                                                                                                                                             | If Captured as Specialized                                                                                                                                                                                                   | If Captured as Generalized                                                                                                                                                                                                                                                                                 |
|---------------------------|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Windows Generalized       | <strong>Error:</strong> Provisioning timeout<br /><strong>Resolution</strong>: Use the original VHD that’s available on-prem, run sysprep, and then <a href="https://msdn.microsoft.com/library/mt603554.aspx/">use Add-AzureRMVhd to upload</a> as generalized.      | No error                                                                                                                                                                                                                                               | <strong>Error</strong>: Provisioning timeout, because the original VM is not usable as it is marked as generalized.<br /><strong>Resolution:</strong> Delete the current image from the portal, and <a href="https://azure.microsoft.com/documentation/articles/virtual-machines-windows-capture-image/">recreate it from the current VHDs with the generalized setting</a>. | No error                                                                                                                                                                                                                                                                                                   |
| Windows Specialized       | No error                                                                                                                                 | <strong>Error</strong>: Provisioning failure, because the new VM is running with the original computer name, username and password.<br /><strong>Resolution:</strong> Use the original VHD that’s available on-prem to <a href="https://msdn.microsoft.com/library/mt603554.aspx/">upload</a> as specialized, or run sysprep to make the OS generalized.      | No error                                                                                                                                                                                                                     | <strong>Error</strong>: Provisioning failure, because the new VM is running with the original computer name, username and password. The original VM is not usable as it is marked as specialized.<br /><strong>Resolution:</strong> Delete the current image from the portal, and <a href="https://azure.microsoft.com/documentation/articles/virtual-machines-windows-capture-image/">recreate it from the current VHDs with the specialized setting</a>. |
| Linux Generalized         | <strong>Error</strong>: Provisioning timeout<br /><strong>Resolution:</strong> Use the original VHD that’s available on-prem, run -deprovision, and then upload as generalized. | No error                                                                                                                                                                                                                                               | <strong>Error</strong>: Provisioning timeout, because the original VM is not usable as it is marked as generalized.<br /><strong>Resolution:</strong> Delete the current image from the portal, and <a href="https://azure.microsoft.com/documentation/articles/virtual-machines-linux-capture-image/">recreate it from the current VHDs with the generalized setting</a>. | No error                                                                                                                                                                                                                                                                                                   |
| Linux Specialized         | No error                                                                                                                                 | <strong>Error</strong>: Provisioning failure, because the new VM is running with the original computer name, username and password.<br /><strong>Resolution:</strong> Use the original VHD that’s available on-prem to upload as specialized, or run -deprovision to make the OS generalized. | No error                                                                                                                                                                                                                     | <strong>Error</strong>: Provisioning failure, because the new VM is running with the original computer name, username and password. The original VM is not usable as it is marked as specialized.<br /><strong>Resolution:</strong> Delete the current image from the portal, and <a href="https://azure.microsoft.com/documentation/articles/virtual-machines-linux-capture-image/">recreate it from the current VHDs with the specialized setting</a>. |
