<html>
    <head>
        <title></title>
    </head>
    <body>
<h1>How to Create and Deploy a Cloud Service</h1>

<p><div chunk="../../Shared/Chunks/disclaimer.md" /></p>

<p>The Windows Azure (Preview) Management Portal provides two ways for you to create and deploy a cloud service: <strong>Quick Create</strong> and <strong>Custom Create</strong>. </p>

<p>This topic explains how to use the Quick Create method to create a new cloud service and then use <strong>Upload</strong> to upload and deploy a cloud service package in Windows Azure. When you use this method, the Windows Azure (Preview) Management Portal makes available convenient links for completing all requirements as you go. If you're ready to deploy your cloud service when you create it, you can do both at the same time using <strong>Custom Create</strong>. </p>

<p><strong>Note</strong>   If you plan to publish your cloud service from Windows Team Foundation Services (TFS), use Quick Create, and then set up TFS publishing from <strong>Quick Start</strong> or the dashboard. For more information, see <a href="http://go.microsoft.com/fwlink/?LinkID=251796&amp;clcid=0x409">Continuous Delivery to Windows Azure by Using Team Foundation Service Preview</a>, or see help for the <strong>Quick Start</strong> page.</p>

<h2>Table of Contents</h2>

<ul>
<li><a href="#concepts">Concepts</a></li>
<li><a href="#prepare">Prepare your app</a></li>
<li><a href="#begin">Before you begin</a></li>
<li><a href="#quick">How to: Create a cloud service using Quick Create</a></li>
<li><a href="#uploadcertificate">How to: Upload a certificate for a cloud service</a></li>
<li><a href="#deploy">How to: Deploy a cloud service</a></li>
</ul>

<h2 id="concepts">Concepts</h2>

<p>Three components are required in order to deploy an application as a cloud service in Windows Azure:</p>

<blockquote>
  <ul>
  <li><p><strong>service definition file</strong>   The cloud service definition file (.csdef) defines the service model, including the number of roles.</p></li>
  <li><p><strong>service configuration file</strong>   The cloud service configuration file (.cscfg) provides configuration settings for the cloud service and individual roles, including the number of role instances.</p></li>
  <li><p><strong>service package</strong>   The service package (.cspkg) contains the application code and the service definition file.</p></li>
  </ul>
</blockquote>

<h2 id="prepare">Prepare your app</h2>

<p>Before you can deploy a cloud service, you must create the cloud service package (.cspkg) from your application code and a cloud service configuration file (.cscfg). Each cloud service package contains application files and configurations. The service configuration file provides the configuration settings.</p>

<p>The Windows Azure SDK provides tools for preparing these required deployment files. You can install the SDK from the <a href="http://www.windowsazure.com/en-us/develop/downloads/">Windows Azure Downloads</a> page, in the language in which you prefer to develop your application code.</p>

<p>If you're new to cloud services, you can download a sample cloud service package (.cspkg) and service configuration file (.cscfg) to work with from the <a href="http://code.msdn.microsoft.com/windowsazure/">Windows Azure Code Samples</a>. </p>

<p>Three cloud service features require special configurations before you export a service package:</p>

<ul>
<li><p>If you want to deploy a cloud service that uses Secure Sockets Layer (SSL) for data encryption, configure your application for SSL. For more information, see <a href="http://msdn.microsoft.com/en-us/library/windowsazure/ff795779.aspx">How to Configure an SSL Certificate on an HTTPS Endpoint</a>.</p></li>
<li><p>If you want to configure Remote Desktop connections to role instances, configure the roles for Remote Desktop. For more information about preparing the service definition file for remote access, see <a href="http://msdn.microsoft.com/en-us/library/windowsazure/gg433010.aspx">Overview of Setting Up a Remote Desktop Connection for a Role</a>.</p></li>
<li><p>If you want to configure verbose monitoring for your cloud service, enable Windows Azure Diagnostics for the cloud service. <em>Minimal monitoring</em> (the default monitoring level) uses performance counters gathered from the host operating systems for role instances (virtual machines). "Verbose monitoring* gathers additional metrics based on performance data within the role instances to enable closer analysis of issues that occur during application processing. To find out how to enable Windows Azure Diagnostics, see <a href="http://www.windowsazure.com/en-us/develop/net/common-tasks/diagnostics/">Enabling Diagnostics in Windows Azure</a>.</p></li>
</ul>

<h2 id="begin">Before you begin</h2>

<ul>
<li><p>If you havenâ€™t installed the Windows Azure SDK, click <strong>Install Azure SDK</strong> to open the <a href="http://www.windowsazure.com/en-us/develop/downloads/">Windows Azure Downloads page</a>, and then download the SDK for the language in which you prefer to develop your code. (You'll have an opportunity to do this later.)</p></li>
<li><p>If any role instances require a certificate, create the certificates. Cloud services require a .pfx file with a private key. You can upload the certificates to Windows Azure as you create and deploy the cloud service. For information about creating certificates, see <a href="http://msdn.microsoft.com/en-us/library/windowsazure/ff795779.aspx">How to Configure an SSL Certificate on an HTTPS Endpoint</a>.</p></li>
<li><p>If you plan to deploy the cloud service to an affinity group, create the affinity group. You can use an affinity group to deploy your cloud service and other Windows Azure services to the same location in a region. You can create the affinity group in the <strong>Networks</strong> area of the Management Portal, on the <strong>Affinity Groups</strong> page. For more information, see help for the <strong>Affinity Groups</strong> page.</p></li>
</ul>

<h2 id="quick">How to: Create a cloud service using Quick Create</h2>

<ol>
<li><p>In the <a href="http://manage.windowsazure.com/">Management Portal</a>, click <strong>New</strong>, click <strong>Cloud Service</strong>, and then click <strong>Quick Create</strong>.</p>

<p><img src="../Media/CloudServices_QuickCreate.png" alt="CloudServices_QuickCreate" /></p></li>
<li><p>In <strong>URL</strong>, enter a subdomain name to use in the public URL for accessing your cloud service in production deployments. The URL format for production deployments is: <a href="http://myURL.cloudapp.net">http://<em>myURL</em>.cloudapp.net</a>.</p></li>
<li><p>In <strong>Region/Affinity Group</strong>, select the geographic region or affinity group to deploy the cloud service to. Select an affinity group if you want to deploy your cloud service to the same location as other Windows Azure services within a region.</p>

<p><strong>Note</strong>   To create an affinity group, open the <strong>Networks</strong> area of the Management Portal, click <strong>Affinity Groups</strong>, and then click either <strong>Create a new affinity group</strong> or <strong>Create</strong>. You can use affinity groups that you created in the earlier Windows Azure Management Portal. And you can create and manage affinity groups using the Windows Azure Service Management API. For more information, see <a href="http://msdn.microsoft.com/en-us/library/windowsazure/ee460798.aspx">Operations on Affinity Groups</a>.</p></li>
<li><p>Click <strong>Create Cloud Service</strong>.</p></li>
</ol>

<p>You can monitor the status of the process in the message area at the bottom of the window.</p>

<p>The <strong>Cloud Services</strong> area opens, with the new cloud service displayed. When the status changes to Created, cloud service creation has completed successfully.</p>

<p><img src="../Media/CloudServices_CloudServicesPage.png" alt="CloudServices_CloudServicesPage" /></p>

<p>If any roles in the cloud service require a certificate for Secure Sockets Layer (SSL) data encryption, and the certificate has not been uploaded to Windows Azure, you must upload the certificate before you deploy the cloud service. After you upload a certificate, any Windows applications that are running in the role instances can access the certificate.</p>

<h2 id="uploadcertificate">How to: Upload a certificate for a cloud service</h2>

<ol>
<li><p>In the <a href="http://manage.windowsazure.com/">Management Portal</a>, click <strong>Cloud Services</strong>. Then click the name of the cloud service to open the dashboard.</p>

<p><img src="../Media/CloudServices_EmptyDashboard.png" alt="CloudServices_EmptyDashboard" /></p></li>
<li><p>Click <strong>Certificates</strong> to open the <strong>Certificates</strong> page, shown below.</p>

<p><img src="../Media/CloudServices_CertificatesPage.png" alt="CloudServices_CertificatesPage" /></p></li>
<li><p>Click either <strong>Add new certificate</strong> or <strong>Upload</strong>.
<strong>Add a Certificate</strong> opens.</p>

<p><img src="../Media/CloudServices_AddaCertificate.png" alt="CloudServices_AddaCertificate" /></p></li>
<li><p>In <strong>Certificate file</strong>, use <strong>Browse</strong> to select the certificate (.pfx file) to use.</p></li>
<li><p>In <strong>Password</strong>, enter the private key for the certificate.</p></li>
<li><p>Click OK (checkmark).</p></li>
</ol>

<p>You can watch the progress of the upload in the message area, shown below. When the upload completes, the certificate is added to the table. In the message area, click the down arrow to close the message, or click X to remove the message.</p>

<p><img src="../Media/CloudServices_CertificateProgress.png" alt="CloudServices_CertificateProgress" /></p>

<p>You can deploy your cloud service from the dashboard or from <strong>Quick Start</strong>.</p>

<h2 id="deploy">How to: Deploy a cloud service</h2>

<ol>
<li><p>In the <a href="http://manage.windowsazure.com/">Management Portal</a>, click <strong>Cloud Services</strong>. Then click the name of the cloud service to open the dashboard.</p></li>
<li><p>Click <strong>Quick Start</strong> (the icon to the left of <strong>Dashboard</strong>) to open the <strong>Quick Start</strong> page, shown below. (You can also deploy your cloud service by using <strong>Upload</strong> on the dashboard.)</p>

<p><img src="../Media/CloudServices_QuickStartPage.png" alt="CloudServices_QuickStartPage" /></p></li>
<li><p>If you haven't installed the Windows Azure SDK, click <strong>Install Azure SD</strong>K to open the <a href="http://www.windowsazure.com/en-us/develop/downloads/">Windows Azure Downloads page</a>, and then download the SDK for the language in which you prefer to develop your code.</p>

<p>On the downloads page, you can also install client libraries and source code for developing web apps in Node.js, Java, PHP, and other languages, which you can deploy as scalable Windows Azure cloud services.</p>

<p><strong>Note</strong>   For cloud services created earlier (known earlier as <em>hosted services</em>), you'll need to make sure the guest operating systems on the virtual machines (role instances) are compatible with the Windows Azure SDK version you install. For more information, see the <a href="http://msdn.microsoft.com/en-us/library/windowsazure/hh552718.aspx">Windows Azure SDK release notes</a>.</p></li>
<li><p>Click either <strong>New Production Deployment</strong> or <strong>New Staging Deployment</strong>. </p>

<p>If you'd like to test your cloud service in Windows Azure before deploying it to production, you can deploy to staging. In the staging environment, the cloud service's globally unique identifier (GUID) identifies the cloud service in URLs (<em>GUID</em>.cloudapp.net). In the production environment, the friendlier DNS prefix that you assign is used (for example, <em>myservice</em>.cloudapp.net). When you're ready to promote your staged cloud service to production, use <strong>Swap</strong> to redirect client requests to that deployment.</p>

<p>When you select a deployment environment, <strong>Upload a Package</strong> opens.</p>

<p><img src="../Media/CloudServices_UploadaPackage.png" alt="CloudServices_UploadaPackage" /></p></li>
<li><p>In <strong>Deployment name</strong>, enter a name for the new deployment - for example, MyCloudServicev1.</p></li>
<li><p>In <strong>Package</strong>, use <strong>Browse</strong> to select the service package file (.cspkg) to use.</p></li>
<li><p>In <strong>Configuration</strong>, use <strong>Browse</strong> to select the service configure file (.cscfg) to use.</p></li>
<li><p>If the cloud service will include any roles with only one instance, select the <strong>Deploy even if one or more roles contain a single instance</strong> check box to enable the deployment to proceed.</p>

<p>Windows Azure can only guarantee 99.95 percent access to the cloud service during maintenance and service updates if every role has at least two instances. If needed, you can add additional role instances on the <strong>Scale</strong> page after you deploy the cloud service. For more information, see <a href="http://www.windowsazure.com/en-us/support/legal/sla/">Service Level Agreements</a>.</p></li>
<li><p>Click OK (checkmark) to begin the cloud service deployment.</p>

<p>You can monitor the status of the deployment in the message area. Click the down arrow to hide the message.</p>

<p><img src="../Media/CloudServices_UploadProgress.png" alt="CloudServices_UploadProgress" /></p></li>
</ol>

<h3>To verify that your deployment completed successfully</h3>

<ol>
<li><p>Click <strong>Dashboard</strong>.</p></li>
<li><p>Under <strong>quick glance</strong>, click the site URL to open your cloud service in a web browser.</p>

<p><img src="../Media/CloudServices_QuickGlance.png" alt="CloudServices_QuickGlance" /></p></li>
</ol>
    </body>
</html>
